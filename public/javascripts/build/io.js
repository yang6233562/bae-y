KISSY.add("io/base",function(a,b,c,d){function p(b){var c=b.context;delete b.context,b=a.mix(a.clone(o),b,{deep:!0}),b.context=c||b;var e,g,h=b.type,j=b.dataType;return g=b.uri=l.resolve(b.url),b.uri.setQuery(""),"crossDomain"in b||(b.crossDomain=!b.uri.isSameOriginAs(l)),h=b.type=h.toUpperCase(),b.hasContent=!i.test(h),b.processData&&(e=b.data)&&"string"!=typeof e&&(b.data=a.param(e,d,d,b.serializeArray)),j=b.dataType=a.trim(j||"*").split(f),"cache"in b||!a.inArray(j[0],["script","jsonp"])||(b.cache=!1),b.hasContent||(b.data&&g.query.add(a.unparam(b.data)),b.cache===!1&&g.query.set("_ksTS",a.now()+"_"+a.guid())),b}function q(a,b){r.fire(a,{ajaxConfig:b.config,io:b})}function r(b){function o(a){return function(d){(g=c.timeoutTimer)&&(clearTimeout(g),c.timeoutTimer=0);var e=b[a];e&&e.apply(k,d),q(a,c)}}var c=this;if(!(c instanceof r))return new r(b);h.call(c),b=p(b),a.mix(c,{responseData:null,config:b||{},timeoutTimer:null,responseText:null,responseXML:null,responseHeadersString:"",responseHeaders:null,requestHeaders:{},readyState:0,state:0,statusText:null,status:0,transport:null,_defer:new a.Defer(this)});var d,e;q("start",c),d=n[b.dataType[0]]||n["*"],e=new d(c),c.transport=e,b.contentType&&c.setRequestHeader("Content-Type",b.contentType);var g,i,f=b.dataType[0],j=b.timeout,k=b.context,l=b.headers,m=b.accepts;c.setRequestHeader("Accept",f&&m[f]?m[f]+("*"===f?"":", */*; q=0.01"):m["*"]);for(i in l)c.setRequestHeader(i,l[i]);if(b.beforeSend&&b.beforeSend.call(k,c,b)===!1)return c;c.done(o("success"),o("error")),c.fin(o("complete")),c.readyState=1,q("send",c),b.async&&j>0&&(c.timeoutTimer=setTimeout(function(){c.abort("timeout")},1e3*j));try{c.state=1,e.send()}catch(s){c.state<2&&c._ioReady(-1,s.message)}return c}var e=/^(?:about|app|app\-storage|.+\-extension|file|widget)$/,f=/\s+/,g=function(a){return a},h=a.Promise,i=/^(?:GET|HEAD)$/,j=a.Env.host,k=j.location||{},l=new a.Uri(k.href),m=l&&e.test(l.getScheme()),n={},o={type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",async:!0,serializeArray:!0,processData:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},converters:{text:{json:a.parseJSON,html:g,text:g,xml:a.parseXML}},contents:{xml:/xml/,html:/html/,json:/json/}};return o.converters.html=o.converters.text,a.mix(r,c.Target),a.mix(r,{isLocal:m,setupConfig:function(b){a.mix(o,b,{deep:!0})},setupTransport:function(a,b){n[a]=b},getTransport:function(a){return n[a]},getConfig:function(){return o}}),r},{requires:["json","event"]}),KISSY.add("io/form-serializer",function(a,b){function g(a){return a.replace(d,"\r\n")}var e,c=/^(?:select|textarea)/i,d=/\r?\n/g,f=/^(?:color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i;return e={serialize:function(b,c){return a.param(e.getFormData(b),void 0,void 0,c||!1)},getFormData:function(d){var e=[],h={};return a.each(b.query(d),function(b){var c=b.elements?a.makeArray(b.elements):[b];e.push.apply(e,c)}),e=a.filter(e,function(a){return a.name&&!a.disabled&&(a.checked||c.test(a.nodeName)||f.test(a.type))}),a.each(e,function(c){var e,d=b.val(c);if(null!==d){if(d=a.isArray(d)?a.map(d,g):g(d),e=h[c.name],!e)return h[c.name]=d,void 0;e&&!a.isArray(e)&&(e=h[c.name]=[e]),e.push.apply(e,a.makeArray(d))}}),h}}},{requires:["dom"]}),KISSY.add("io/form",function(a,b,c,d){var e=a.Env.host,f=Array.prototype.slice,g=e.FormData;return b.on("start",function(b){var h,i,j,k,l,m,e=b.io,n=e.config;if(m=n.form){h=c.get(m),l=n.data;for(var o=!1,p={},q=c.query("input",h),r=0,s=q.length;s>r;r++){var t=q[r];if("file"==t.type.toLowerCase()){if(o=!0,!g)break;var u=f.call(t.files,0);p[c.attr(t,"name")]=u.length>1?u:u[0]||null}}o&&g&&(n.files=n.files||{},a.mix(n.files,p),delete n.contentType),!o||g?(k=d.getFormData(h),n.hasContent?(k=a.param(k,void 0,void 0,n.serializeArray),l?n.data+="&"+k:n.data=k):n.uri.query.add(k)):(j=n.dataType,i=j[0],"*"==i&&(i="text"),j.length=2,j[0]="iframe",j[1]=i)}}),b},{requires:["./base","dom","./form-serializer"]}),KISSY.add("io/iframe-transport",function(a,b,c,d){function j(c){var f,d=a.guid("io-iframe"),g=b.getEmptyIframeSrc();return f=c.iframe=b.create("<iframe "+(g?' src="'+g+'" ':"")+' id="'+d+'"'+' name="'+d+'"'+' style="position:absolute;left:-9999px;top:-9999px;"/>'),b.prepend(f,e.body||e.documentElement),f}function k(c,d,f){var h,i,j,k,g=[];return a.each(c,function(c,l){for(h=a.isArray(c),i=a.makeArray(c),j=0;j<i.length;j++)k=e.createElement("input"),k.type="hidden",k.name=l+(h&&f?"[]":""),k.value=i[j],b.append(k,d),g.push(k)}),g}function l(a){b.remove(a)}function m(a){this.io=a}var e=a.Env.host.document,f=200,g=500,h=30,i=a.clone(d.getConfig().converters.text);return i.json=function(b){return a.parseJSON(a.unEscapeHTML(b))},d.setupConfig({converters:{iframe:i,text:{iframe:function(a){return a}},xml:{iframe:function(a){return a}}}}),a.augment(m,{send:function(){function n(){c.on(h,"load error",d._callback,d),m.submit()}var g,h,i,d=this,e=d.io,f=e.config,l=f.data,m=b.get(f.form);d.attrs={target:b.attr(m,"target")||"",action:b.attr(m,"action")||"",encoding:b.attr(m,"encoding"),enctype:b.attr(m,"enctype"),method:b.attr(m,"method")},d.form=m,h=j(e),b.attr(m,{target:h.id,action:e._getUrlForSend(),method:"post",enctype:"multipart/form-data",encoding:"multipart/form-data"}),l&&(i=a.unparam(l)),i&&(g=k(i,m,f.serializeArray)),d.fields=g,6==a.UA.ie?setTimeout(n,0):n()},_callback:function(d){var m,e=this,i=e.form,j=e.io,k=d.type,n=j.iframe;if(n)if("abort"==k&&6==a.UA.ie?setTimeout(function(){b.attr(i,e.attrs)},0):b.attr(i,e.attrs),l(this.fields),c.detach(n),setTimeout(function(){b.remove(n)},h),j.iframe=null,"load"==k)try{m=n.contentWindow.document,m&&m.body&&(j.responseText=b.html(m.body),a.startsWith(j.responseText,"<?xml")&&(j.responseText=void 0)),j.responseXML=m&&m.XMLDocument?m.XMLDocument:m,m?j._ioReady(f,"success"):j._ioReady(g,"parser error")}catch(o){j._ioReady(g,"parser error")}else"error"==k&&j._ioReady(g,"error")},abort:function(){this._callback({type:"abort"})}}),d.setupTransport("iframe",m),d},{requires:["dom","event","./base"]}),KISSY.add("io",function(a,b,c){function e(b,e,f,g,h){return a.isFunction(e)&&(g=f,f=e,e=d),c({type:h||"get",url:b,data:e,success:f,dataType:g})}var d=void 0;return a.mix(c,{serialize:b.serialize,get:e,post:function(b,c,f,g){return a.isFunction(c)&&(g=f,f=c,c=d),e(b,c,f,g,"post")},jsonp:function(b,c,f){return a.isFunction(c)&&(f=c,c=d),e(b,c,f,"jsonp")},getScript:a.getScript,getJSON:function(b,c,f){return a.isFunction(c)&&(f=c,c=d),e(b,c,f,"json")},upload:function(b,e,f,g,h){return a.isFunction(f)&&(h=g,g=f,f=d),c({url:b,type:"post",dataType:h,form:e,data:f,success:g})}}),a.mix(a,{Ajax:c,IO:c,ajax:c,io:c,jsonp:c.jsonp}),c},{requires:["io/form-serializer","io/base","io/xhr-transport","io/script-transport","io/jsonp","io/form","io/iframe-transport","io/methods"]}),KISSY.add("io/jsonp",function(a,b){var c=a.Env.host;return b.setupConfig({jsonp:"callback",jsonpCallback:function(){return a.guid("jsonp")}}),b.on("start",function(b){var d=b.io,e=d.config,f=e.dataType;if("jsonp"==f[0]){var g,i,h=e.jsonpCallback,j=a.isFunction(h)?h():h,k=c[j];e.uri.query.set(e.jsonp,j),c[j]=function(b){arguments.length>1&&(b=a.makeArray(arguments)),g=[b]},d.fin(function(){if(c[j]=k,void 0===k)try{delete c[j]}catch(a){}else g&&k(g[0])}),i=e.converters,i.script=i.script||{},i.script.json=function(){return g[0]},f.length=2,f[0]="script",f[1]="json"}}),b},{requires:["./base"]}),KISSY.add("io/methods",function(a,b,c){function i(b){var h,i,j,d=b.responseText,e=b.responseXML,f=b.config,g=f.converters,k=f.contents,l=f.dataType;if(d||e){for(i=b.mimeType||b.getResponseHeader("Content-Type");"*"==l[0];)l.shift();if(!l.length)for(h in k)if(k[h].test(i)){l[0]!=h&&l.unshift(h);break}l[0]=l[0]||"text";for(var m=0;m<l.length;m++){if("text"==l[m]&&d!==c){j=d;break}if("xml"==l[m]&&e!==c){j=e;break}}if(!j){var n={text:d,xml:e};a.each(["text","xml"],function(a){var b=l[0],f=g[a]&&g[a][b];return f&&n[a]?(l.unshift(a),j="text"==a?d:e,!1):c})}}for(var o=l[0],p=1;p<l.length;p++){h=l[p];var q=g[o]&&g[o][h];if(!q)throw"no covert for "+o+" => "+h;j=q(j),o=h}b.responseData=j}var d=200,e=a.Promise,f=300,g=304,h=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm;a.extend(b,e,{setRequestHeader:function(a,b){var c=this;return c.requestHeaders[a]=b,c},getAllResponseHeaders:function(){var a=this;return 2===a.state?a.responseHeadersString:null},getResponseHeader:function(a){var b,e,d=this;if(2===d.state){if(!(e=d.responseHeaders))for(e=d.responseHeaders={};b=h.exec(d.responseHeadersString);)e[b[1]]=b[2];b=e[a]}return b===c?null:b},overrideMimeType:function(a){var b=this;return b.state||(b.mimeType=a),b},abort:function(a){var b=this;return a=a||"abort",b.transport&&b.transport.abort(a),b._ioReady(0,a),b},getNativeXhr:function(){var a;return(a=this.transport)?a.nativeXhr:null},_ioReady:function(a,b){var c=this;if(2!=c.state){c.state=2,c.readyState=4;var e;if(a>=d&&f>a||a==g)if(a==g)b="not modified",e=!0;else try{i(c),b="success",e=!0}catch(h){b="parser error"}else 0>a&&(a=0);c.status=a,c.statusText=b;var j=c._defer;j[e?"resolve":"reject"]([c.responseData,b,c])}},_getUrlForSend:function(){var b=this.config,c=b.uri,d=a.Uri.getComponents(b.url).query||"",e=c.toString.call(c,b.serializeArray);return e+(d?(c.query.has()?"&":"?")+d:d)}})},{requires:["./base"]}),KISSY.add("io/script-transport",function(a,b,c,d){function i(a){var c=a.config;return c.crossDomain?(this.io=a,this):new(b.getTransport("*"))(a)}var e=a.Env.host,f=e.document,g=200,h=500;return b.setupConfig({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{text:{script:function(b){return a.globalEval(b),b}}}}),a.augment(i,{send:function(){var b,a=this,c=a.io,d=c.config,g=f.head||f.getElementsByTagName("head")[0]||f.documentElement;a.head=g,b=f.createElement("script"),a.script=b,b.async=!0,d.scriptCharset&&(b.charset=d.scriptCharset),b.src=c._getUrlForSend(),b.onerror=b.onload=b.onreadystatechange=function(b){b=b||e.event,a._callback((b.type||"error").toLowerCase())},g.insertBefore(b,g.firstChild)},_callback:function(a,b){var c=this,e=c.script,f=c.io,i=c.head;e&&(b||!e.readyState||/loaded|complete/.test(e.readyState)||"error"==a)&&(e.onerror=e.onload=e.onreadystatechange=null,i&&e.parentNode&&i.removeChild(e),c.script=d,c.head=d,b||"error"==a?"error"==a&&f._ioReady(h,"script error"):f._ioReady(g,"success"))},abort:function(){this._callback(0,1)}}),b.setupTransport("script",i),b},{requires:["./base","./xhr-transport"]}),KISSY.add("io/sub-domain-transport",function(a,b,c,d){function h(a){var b=this,c=a.config;b.io=a,c.crossDomain=!1}function i(){var a=this,b=a.io.config,d=b.uri,e=d.getHostname(),f=g[e];f.ready=1,c.detach(f.iframe,"load",i,a),a.send()}var e="/sub_domain_proxy.html",f=a.Env.host.document,g={};return a.augment(h,b.proto,{send:function(){var m,n,h=this,j=h.io.config,k=j.uri,l=k.getHostname(),o=g[l],p=e;return j.xdr&&j.xdr.subDomain&&j.xdr.subDomain.proxy&&(p=j.xdr.subDomain.proxy),o&&o.ready?(h.nativeXhr=b.nativeXhr(0,o.iframe.contentWindow),h.nativeXhr&&h.sendInternal(),void 0):(o?m=o.iframe:(o=g[l]={},m=o.iframe=f.createElement("iframe"),d.css(m,{position:"absolute",left:"-9999px",top:"-9999px"}),d.prepend(m,f.body||f.documentElement),n=new a.Uri,n.setScheme(k.getScheme()),n.setPort(k.getPort()),n.setHostname(l),n.setPath(p),m.src=n.toString()),c.on(m,"load",i,h),void 0)}}),h},{requires:["./xhr-transport-base","event","dom"]}),KISSY.add("io/xdr-flash-transport",function(a,b,c){function i(a,b,d){if(!h){h=!0;var f='<object id="'+e+'" type="application/x-shockwave-flash" data="'+a+'" width="0" height="0">'+'<param name="movie" value="'+a+'" />'+'<param name="FlashVars" value="yid='+b+"&uid="+d+'&host=KISSY.IO" />'+'<param name="allowScriptAccess" value="always" />'+"</object>",i=g.createElement("div");c.prepend(i,g.body||g.documentElement),i.innerHTML=f}}function j(a){this.io=a}var f,d={},e="io_swf",g=a.Env.host.document,h=!1;return a.augment(j,{send:function(){var b=this,c=b.io,e=c.config,g=e.xdr||{};return i(g.src||a.Config.base+"io/assets/io.swf",1,1),f?(b._uid=a.guid(),d[b._uid]=b,f.send(c._getUrlForSend(),{id:b._uid,uid:b._uid,method:e.type,data:e.hasContent&&e.data||{}}),void 0):(setTimeout(function(){b.send()},200),void 0)},abort:function(){f.abort(this._uid)},_xdrResponse:function(a,b){var e,g,c=this,f=b.id,h=b.c,i=c.io;switch(h&&(g=h.responseText)&&(i.responseText=decodeURI(g)),a){case"success":e={status:200,statusText:"success"},delete d[f];break;case"abort":delete d[f];break;case"timeout":case"transport error":case"failure":delete d[f],e={status:"status"in h?h.status:500,statusText:h.statusText||a}}e&&i._ioReady(e.status,e.statusText)}}),b.applyTo=function(c,d,e){var f=d.split(".").slice(1),g=b;a.each(f,function(a){g=g[a]}),g.apply(null,e)},b.xdrReady=function(){f=g.getElementById(e)},b.xdrResponse=function(a,b){var c=d[b.uid];c&&c._xdrResponse(a,b)},j},{requires:["./base","dom"]}),KISSY.add("io/xhr-transport-base",function(a,b){function l(a,b){try{return new(b||d).XMLHttpRequest}catch(c){}return void 0}function m(a,b){try{return new(b||d).ActiveXObject("Microsoft.XMLHTTP")}catch(c){}return void 0}function n(a){return e&&a instanceof e}function o(a){var c,b=a.ifModified;return b&&(c=a.uri,a.cache===!1&&(c=c.clone(),c.query.remove("_ksTS")),c=c.toString()),c}var c=200,d=a.Env.host,e=a.UA.ie>7&&d.XDomainRequest,f=204,g=404,h=1223,i={proto:{}},j={},k={};return b.__lastModifiedCached=j,b.__eTagCached=k,i.nativeXhr=d.ActiveXObject?function(a,c){return!i.supportCORS&&a&&e?new e:!b.isLocal&&l(a,c)||m(a,c)}:l,i._XDomainRequest=e,i.supportCORS="withCredentials"in i.nativeXhr(),a.mix(i.proto,{sendInternal:function(){var i,q,s,t,b=this,c=b.io,d=c.config,e=b.nativeXhr,f=d.files,g=f?"post":d.type,h=d.async,l=c.mimeType,m=c.requestHeaders||{},p=c._getUrlForSend(),r=o(d);r&&((s=j[r])&&(m["If-Modified-Since"]=s),(s=k[r])&&(m["If-None-Match"]=s)),(i=d.username)?e.open(g,p,h,i,d.password):e.open(g,p,h);var u=0;if(q=d.xhrFields)for(t in q)"withCredentials"==t&&(u=1),e[t]=q[t];if(u||(e.withCredentials=!0),l&&e.overrideMimeType&&e.overrideMimeType(l),m["X-Requested-With"]||(m["X-Requested-With"]="XMLHttpRequest"),"undefined"!=typeof e.setRequestHeader)for(t in m)e.setRequestHeader(t,m[t]);var v=d.hasContent&&d.data||null;if(f){var w=v,x={};w&&(x=a.unparam(w)),x=a.mix(x,f),v=new FormData,a.each(x,function(b,c){a.isArray(b)?a.each(b,function(a){v.append(c+(d.serializeArray?"[]":""),a)}):v.append(c,b)})}e.send(v),h&&4!=e.readyState?n(e)?(e.onload=function(){e.readyState=4,e.status=200,b._callback()},e.onerror=function(){e.readyState=4,e.status=500,b._callback()}):e.onreadystatechange=function(){b._callback()}:b._callback()},abort:function(){this._callback(0,1)},_callback:function(d,e){var p,q,r,s,t,i=this,l=i.nativeXhr,m=i.io,u=m.config;try{if(e||4==l.readyState)if(n(l)?(l.onerror=a.noop,l.onload=a.noop):l.onreadystatechange=a.noop,e)4!==l.readyState&&l.abort();else{p=o(u);var v=l.status;n(l)||(m.responseHeadersString=l.getAllResponseHeaders()),p&&(q=l.getResponseHeader("Last-Modified"),r=l.getResponseHeader("ETag"),q&&(j[p]=q),r&&(k[r]=r)),t=l.responseXML,t&&t.documentElement&&(m.responseXML=t);var w=m.responseText=l.responseText;if(u.files&&w){var x,y;-1!=(x=w.indexOf("<body>"))&&(y=w.lastIndexOf("</body>"),-1==y&&(y=w.length),w=w.slice(x+6,y)),m.responseText=a.unEscapeHTML(w)}try{s=l.statusText}catch(z){s=""}v||!b.isLocal||u.crossDomain?v===h&&(v=f):v=m.responseText?c:g,m._ioReady(v,s)}}catch(A){l.onreadystatechange=a.noop,e||m._ioReady(-1,A)}}}),i},{requires:["./base"]}),KISSY.add("io/xhr-transport",function(a,b,c,d,e){function i(b){return g.domain&&a.endsWith(b,g.domain)}function j(a){var j,b=a.config,f=b.crossDomain,g=this,k=b.xdr||{},l=k.subDomain=k.subDomain||{};if(g.io=a,f&&!c.supportCORS){if(i(b.uri.getHostname())&&l.proxy!==!1)return new d(a);if("flash"===String(k.use)||!h)return new e(a)}return j=g.nativeXhr=c.nativeXhr(f),g}var f=a.Env.host,g=f.document,h=c._XDomainRequest;return a.augment(j,c.proto,{send:function(){this.sendInternal()}}),b.setupTransport("*",j),b},{requires:["./base","./xhr-transport-base","./sub-domain-transport","./xdr-flash-transport"]});